(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[123],{9514:function(e,t,r){Promise.resolve().then(r.bind(r,3567))},3567:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return f}});var l=r(7437),a=r(2265),n=r(7648),o=r(9376),s=r(6942),i=r(3582),d=r(5480);let u=new Set(["admin","www","api","app","mail","ftp","staging","dev","test","localhost","null","undefined"].map(e=>e.toLowerCase())),c=/^[a-z0-9]([a-z0-9-]*[a-z0-9])?$/;function m(){return(0,l.jsx)("div",{className:"rounded-lg border border-blue-200 bg-blue-50/80 px-3 py-2.5 text-sm text-blue-800",children:(0,l.jsx)("p",{className:"font-medium",children:"任意の箇所にもなるべく多く記入していただくと、より理想に近い外観デザインに仕上がります。"})})}let x=["魚介類","生花・フラワー","野菜・果物","精肉","惣菜・加工品","雑貨・生活用品","ハンドクラフト・アクセサリー","その他"],p=(0,l.jsx)("span",{className:"ml-1 text-xs font-normal text-gray-500",children:"（任意・記入するとデザインの精度が上がります）"}),b=(0,l.jsx)("span",{className:"ml-1 text-xs font-normal text-gray-500",children:"（任意・記入するとデザインの精度が上がります）"}),h=[{id:"basic",label:"基本情報",Component:function(e){var t,r,a;let{data:n,onChange:o}=e,s=e=>{var t;let r=null!==(t=n.productCategories)&&void 0!==t?t:[];o({productCategories:r.includes(e)?r.filter(t=>t!==e):[...r,e]})};return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["店舗名 ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",value:null!==(t=n.storeName)&&void 0!==t?t:"",onChange:e=>o({storeName:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 田中商店",required:!0})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["お店のページアドレス（○○.marche-link.jp の ○○ の部分）"," ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",value:null!==(r=n.subdomain)&&void 0!==r?r:"",onChange:e=>o({subdomain:e.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"")}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: tanaka と入れると tanaka.marche-link.jp になります",required:!0}),(0,l.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"半角英小文字・数字・ハイフンのみ。admin, www は使えません。"})]}),(0,l.jsx)(m,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["説明・キャッチコピー",(0,l.jsx)("span",{className:"ml-1 text-xs font-normal text-gray-500",children:"（任意・記入するとデザインの精度が上がります）"})]}),(0,l.jsx)("textarea",{value:null!==(a=n.description)&&void 0!==a?a:"",onChange:e=>o({description:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",rows:2,placeholder:"例: 新鮮な魚介をお届けします"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["取扱商品カテゴリ・ジャンル（複数可）",(0,l.jsx)("span",{className:"ml-1 text-xs font-normal text-gray-500",children:"（任意・記入推奨）"})]}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:x.map(e=>{var t;return(0,l.jsx)("button",{type:"button",onClick:()=>s(e),className:"px-3 py-1 rounded-full text-sm border ".concat((null!==(t=n.productCategories)&&void 0!==t?t:[]).includes(e)?"bg-blue-100 border-blue-300 text-blue-800":"bg-white border-gray-300 text-gray-700"),children:e},e)})})]})]})}},{id:"concept",label:"コンセプト・ターゲット",Component:function(e){var t,r,a,n,o;let{data:s,onChange:i}=e;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(m,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["コンセプト ",p]}),(0,l.jsx)("textarea",{value:null!==(t=s.concept)&&void 0!==t?t:"",onChange:e=>i({concept:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",rows:2,placeholder:"例: 地元の海の幸をその日の朝に"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["ターゲット客層 ",p]}),(0,l.jsx)("input",{type:"text",value:null!==(r=s.targetAudience)&&void 0!==r?r:"",onChange:e=>i({targetAudience:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 30〜50代のご家庭"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["店舗の雰囲気 ",p]}),(0,l.jsx)("input",{type:"text",value:null!==(a=s.atmosphere)&&void 0!==a?a:"",onChange:e=>i({atmosphere:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 明るく親しみやすい"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["立地・規模 ",p]}),(0,l.jsx)("input",{type:"text",value:null!==(n=s.locationScale)&&void 0!==n?n:"",onChange:e=>i({locationScale:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 商店街の一角、小規模"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["価格帯 ",p]}),(0,l.jsx)("input",{type:"text",value:null!==(o=s.priceRange)&&void 0!==o?o:"",onChange:e=>i({priceRange:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 手頃な価格帯"})]})]})}},{id:"design",label:"デザイン希望",Component:function(e){var t,r,a,n;let{data:o,onChange:s}=e;return(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)(m,{}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["希望する色 ",b]}),(0,l.jsx)("input",{type:"text",value:null!==(t=o.preferredColors)&&void 0!==t?t:"",onChange:e=>s({preferredColors:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 青・白・ナチュラル"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["避けたい色 ",b]}),(0,l.jsx)("input",{type:"text",value:null!==(r=o.avoidColors)&&void 0!==r?r:"",onChange:e=>s({avoidColors:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 派手な赤"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["参考にしたいイメージ ",b]}),(0,l.jsx)("input",{type:"text",value:null!==(a=o.referenceImage)&&void 0!==a?a:"",onChange:e=>s({referenceImage:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"例: 落ち着いた和風、ミニマル"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["作風・素材・世界観",(0,l.jsx)("span",{className:"ml-1 text-xs font-normal text-gray-500",children:"（任意・記入推奨・ハンドクラフト向け）"})]}),(0,l.jsx)("textarea",{value:null!==(n=o.styleMaterial)&&void 0!==n?n:"",onChange:e=>s({styleMaterial:e.target.value}),className:"w-full border border-gray-300 rounded px-3 py-2",rows:2,placeholder:"例: 天然石とシルバー、ナチュラル"})]})]})}}];function f(){var e,t;let r=(0,o.useRouter)(),{user:m,loading:x}=(0,s.a)(),[p,b]=(0,a.useState)(0),[f,g]=(0,a.useState)({}),[v,y]=(0,a.useState)(!1),[C,j]=(0,a.useState)(null),N=h[p],w=N.Component,E=p===h.length-1;if(x||!m)return(0,l.jsx)("main",{className:"max-w-2xl mx-auto p-6",children:(0,l.jsxs)("p",{className:"text-gray-500",children:["読み込み中... または ",(0,l.jsx)(n.default,{href:"/admin",className:"text-blue-600",children:"ログイン"})," してください。"]})});let k="basic"!==N.id||!!(null===(e=f.storeName)||void 0===e?void 0:e.trim())&&!!(null===(t=f.subdomain)||void 0===t?void 0:t.trim());return(0,l.jsxs)("main",{className:"max-w-2xl mx-auto p-6",children:[(0,l.jsx)(n.default,{href:"/admin",className:"text-sm text-blue-600 mb-4 inline-block",children:"← 管理画面へ"}),(0,l.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"新規ショップ登録（オンボーディング）"}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 mb-6",children:["ステップ ",p+1," / ",h.length,": ",N.label]}),C&&(0,l.jsx)("p",{className:"text-sm text-red-600 mb-4",role:"alert",children:C}),(0,l.jsx)(w,{data:f,onChange:e=>g(t=>({...t,...e}))}),(0,l.jsxs)("div",{className:"mt-6 flex gap-4",children:[p>0&&(0,l.jsx)("button",{type:"button",onClick:()=>b(e=>e-1),className:"px-4 py-2 border border-gray-300 rounded",children:"戻る"}),(0,l.jsx)("button",{type:"button",onClick:()=>{if(E){var e,t,l;if((null===(e=f.storeName)||void 0===e?void 0:e.trim())&&(null===(t=f.subdomain)||void 0===t?void 0:t.trim())){if(!function(e){let t=e.trim().toLowerCase();return!(!t||u.has(t))&&!(t.length<2)&&!(t.length>32)&&c.test(t)}(null!==(l=f.subdomain)&&void 0!==l?l:"")){j("お店のページアドレスが無効です。予約語・形式を確認してください。");return}y(!0),j(null),(0,d.l)(f).then(e=>{var t,r,l,a;let n=null!=e?e:d.o,o=n[0],s=(null!==(r=f.subdomain)&&void 0!==r?r:"").trim().toLowerCase().replace(/[^a-z0-9-]/g,"");return(0,i.z)({subdomain:s,name:(null!==(l=f.storeName)&&void 0!==l?l:"").trim(),description:(null===(t=f.description)||void 0===t?void 0:t.trim())||void 0,installedPresets:n,activePresetId:o.id,theme:{primaryColor:null!==(a=o.theme.primaryColor)&&void 0!==a?a:o.theme.buttonColor,backgroundColor:o.theme.backgroundColor,fontFamily:o.theme.fontFamily,buttonColor:o.theme.buttonColor,headerColor:o.theme.headerColor,textColor:o.theme.textColor},layoutVariant:"default"})}).then(e=>{let{storeId:t}=e;return r.push("/admin/design?storeId=".concat(t))}).catch(e=>j(e instanceof Error?e.message:"ショップの作成に失敗しました。Cloud Function のデプロイを確認してください。")).finally(()=>y(!1))}}else b(e=>e+1)},disabled:v||!k,className:"px-4 py-2 bg-blue-600 text-white rounded font-medium disabled:opacity-50",children:v?"作成中...":E?"5つのデザインをインストールしてショップを作成":"次へ"})]})]})}},7293:function(e,t,r){"use strict";r.d(t,{E7:function(){return c},G5:function(){return u},V1:function(){return n.V1},lx:function(){return m}});var l=r(738),a=r(3301),n=r(3491),o=r(257);let s={apiKey:o.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:o.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:o.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:o.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:o.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:o.env.NEXT_PUBLIC_FIREBASE_APP_ID},i=null,d=null;function u(){if(!s.apiKey||!s.projectId)return null;if(!i){let e=(0,l.C6)();i=e.length>0?e[0]:(0,l.ZF)(s)}return i}function c(){let e=u();return e?(d||(d=(0,a.getAuth)(e)),d):null}function m(e){let t=u();return t?(0,n.$C)(t,null!=e?e:"asia-northeast1"):null}},6942:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var l=r(2265),a=r(3301),n=r(7293);function o(){let[e,t]=(0,l.useState)(null),[r,o]=(0,l.useState)(!0);return(0,l.useEffect)(()=>{let e=(0,n.E7)();if(!e){o(!1);return}let r=(0,a.Aj)(e,e=>{t(null!=e?e:null),o(!1)});return()=>r()},[]),{user:e,loading:r,signIn:async(e,t)=>{let r=(0,n.E7)();if(!r)throw Error("Firebase Auth が利用できません");await (0,a.e5)(r,e,t)},signOut:async()=>{let e=(0,n.E7)();e&&await (0,a.w7)(e)}}}},3582:function(e,t,r){"use strict";r.d(t,{z:function(){return a}});var l=r(7293);async function a(e){if(!(0,l.G5)())throw Error("Firebase が利用できません");let t=(0,l.lx)("asia-northeast1");if(!t)throw Error("Cloud Functions が利用できません");let r=(0,l.V1)(t,"createStoreWithAdmin");return(await r(e)).data}},5480:function(e,t,r){"use strict";r.d(t,{l:function(){return n},o:function(){return a}});var l=r(7293);let a=[{id:"natural",name:"ナチュラル",description:"落ち着いた自然な配色",theme:{buttonColor:"#4a7c59",headerColor:"#3d6b4d",backgroundColor:"#faf8f5",textColor:"#1f2937",fontFamily:"sans-serif",primaryColor:"#4a7c59"}},{id:"marine",name:"マリン",description:"海をイメージした青系",theme:{buttonColor:"#2563eb",headerColor:"#1d4ed8",backgroundColor:"#f0f9ff",textColor:"#1e3a5f",fontFamily:"sans-serif",primaryColor:"#2563eb"}},{id:"warm",name:"ウォーム",description:"温かみのあるオレンジ・ベージュ",theme:{buttonColor:"#c2410c",headerColor:"#9a3412",backgroundColor:"#fff7ed",textColor:"#431407",fontFamily:"sans-serif",primaryColor:"#c2410c"}},{id:"minimal",name:"ミニマル",description:"シンプル・白基調",theme:{buttonColor:"#171717",headerColor:"#262626",backgroundColor:"#ffffff",textColor:"#171717",fontFamily:"sans-serif",primaryColor:"#171717"}},{id:"craft",name:"クラフト",description:"ハンドメイド向けナチュラル",theme:{buttonColor:"#6b4423",headerColor:"#5c3d1f",backgroundColor:"#fef3c7",textColor:"#292524",fontFamily:"serif",primaryColor:"#6b4423"}}];async function n(e){if(!(0,l.G5)())return a;try{var t;let r=(0,l.lx)("asia-northeast1");if(!r)return a;let n=(0,l.V1)(r,"generateDesignPresets"),o=await n({onboarding:e});return null!==(t=o.data.presets)&&void 0!==t?t:a}catch(e){return a}}}},function(e){e.O(0,[990,322,448,971,117,744],function(){return e(e.s=9514)}),_N_E=e.O()}]);