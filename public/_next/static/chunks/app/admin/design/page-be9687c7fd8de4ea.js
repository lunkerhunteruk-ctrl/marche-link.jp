(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{2662:function(e,t,r){Promise.resolve().then(r.bind(r,312))},312:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var n=r(7437),o=r(2265),l=r(9376),a=r(7648),s=r(5480),i=r(7293);async function d(e,t){if(!(0,i.G5)())throw Error("Firebase が利用できません");let r=(0,i.lx)("asia-northeast1");if(!r)throw Error("Cloud Functions が利用できません");let n=(0,i.V1)(r,"updateStoreActivePreset");await n({storeId:e,activePresetId:t})}function c(e){var t,r,n,o,l,a;let s=e.theme;return{button:null!==(r=null!==(t=s.buttonColor)&&void 0!==t?t:s.primaryColor)&&void 0!==r?r:"#4a7c59",header:null!==(o=null!==(n=s.headerColor)&&void 0!==n?n:s.primaryColor)&&void 0!==o?o:"#3d6b4d",background:null!==(l=s.backgroundColor)&&void 0!==l?l:"#faf8f5",text:null!==(a=s.textColor)&&void 0!==a?a:"#1f2937"}}function u(e){var t;let{preset:r}=e,o=c(r);return(0,n.jsxs)("div",{className:"rounded-lg border-2 border-gray-300 overflow-hidden shadow-md bg-white",children:[(0,n.jsxs)("p",{className:"text-xs text-gray-500 px-2 py-1 bg-gray-100 border-b border-gray-200",children:["プレビュー: ",r.name]}),(0,n.jsxs)("div",{className:"p-3 space-y-3",style:{backgroundColor:o.background,color:o.text,fontFamily:null!==(t=r.theme.fontFamily)&&void 0!==t?t:"sans-serif"},children:[(0,n.jsx)("div",{className:"h-8 rounded flex items-center px-2 text-white text-xs font-medium",style:{backgroundColor:o.header},children:"ショップ名"}),(0,n.jsx)("p",{className:"text-sm",style:{color:o.text},children:"商品名・説明文の文字色"}),(0,n.jsx)("button",{type:"button",className:"px-3 py-1.5 rounded text-sm font-medium text-white",style:{backgroundColor:o.button},children:"カートに入れる"})]})]})}function m(e){let{preset:t}=e,r=c(t),o=[{label:"ボタン",color:r.button},{label:"ヘッダー",color:r.header},{label:"背景",color:r.background},{label:"文字",color:r.text}];return(0,n.jsxs)("div",{className:"mt-2",children:[(0,n.jsx)("p",{className:"text-xs font-medium text-gray-600 mb-1.5",children:"配色"}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2",children:o.map(e=>{let{label:t,color:r}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center gap-0.5",children:[(0,n.jsx)("div",{className:"h-10 w-full rounded border border-gray-200",style:{backgroundColor:r},title:"".concat(t,": ").concat(r)}),(0,n.jsx)("span",{className:"text-xs text-gray-500",children:t})]},t)})})]})}function x(e){let{preset:t,index:r,storeId:l,isPreview:a,onPreview:s,onApply:i,onError:u}=e,[x,f]=(0,o.useState)(!1),b=c(t);return(0,n.jsxs)("li",{role:"group",tabIndex:0,className:"border rounded-lg p-4 bg-white transition-shadow ".concat(a?"ring-2 ring-blue-400 shadow-md":"border-gray-200"),onMouseEnter:s,onFocus:s,children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,n.jsx)("p",{className:"font-medium",children:t.name}),0===r&&(0,n.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full bg-amber-100 text-amber-800 font-medium",children:"デフォルト（おすすめ）"})]}),t.description&&(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-0.5",children:t.description}),(0,n.jsx)(m,{preset:t}),(0,n.jsx)("button",{type:"button",onClick:()=>{f(!0),u(""),d(l,t.id).then(()=>i(t.id)).catch(e=>u(e instanceof Error?e.message:"適用に失敗しました")).finally(()=>f(!1))},disabled:x,className:"mt-4 px-4 py-2 rounded font-medium text-white disabled:opacity-50",style:{backgroundColor:b.button},children:x?"適用中...":"このデザインを適用"})]})}function f(){return(0,n.jsxs)("main",{className:"max-w-2xl mx-auto p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"ショップのデザイン"}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:"ショップ作成後、ここから5つの配色プリセットのうち好きなものをいつでも適用できます。"}),(0,n.jsxs)("p",{className:"text-sm text-gray-500",children:[(0,n.jsx)(a.default,{href:"/admin/onboarding",className:"text-blue-600 underline",children:"新規ショップ登録"}),"を完了すると、このページでデザインを切り替えられます。"]})]})}function b(){var e,t,r;let a=(0,l.useSearchParams)().get("storeId"),[i,d]=(0,o.useState)(null),[c,m]=(0,o.useState)(null),[b,h]=(0,o.useState)(null!==(t=null===(e=s.o[0])||void 0===e?void 0:e.id)&&void 0!==t?t:null),p=null!==(r=s.o.find(e=>e.id===b))&&void 0!==r?r:s.o[0];return a?(0,n.jsxs)("main",{className:"max-w-2xl mx-auto p-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"ショップのデザイン"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-6",children:"5つの配色プリセットから好きなものを選んで適用できます。マウスを乗せると、ボタン・ヘッダー・背景の見た目をプレビューできます。"}),p&&(0,n.jsxs)("section",{className:"mb-8",children:[(0,n.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"適用時の見た目シミュレーション"}),(0,n.jsx)("div",{className:"max-w-xs",children:(0,n.jsx)(u,{preset:p})}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"各プリセットにマウスを乗せると、このプレビューが切り替わります。"})]}),i&&(0,n.jsx)("p",{className:"mb-4 text-sm text-green-700 bg-green-50 border border-green-200 rounded px-3 py-2",children:"デザインを適用しました。"}),c&&(0,n.jsx)("p",{className:"mb-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded px-3 py-2",role:"alert",children:c}),(0,n.jsx)("ul",{className:"space-y-4",children:s.o.map((e,t)=>(0,n.jsx)(x,{preset:e,index:t,storeId:a,isPreview:b===e.id,onPreview:()=>h(e.id),onApply:e=>{d(e),m(null)},onError:m},e.id))}),(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-6",children:"適用には Cloud Function（updateStoreActivePreset）のデプロイが必要です。"})]}):(0,n.jsx)(f,{})}function h(){return(0,n.jsx)(o.Suspense,{fallback:(0,n.jsx)(f,{}),children:(0,n.jsx)(b,{})})}},7293:function(e,t,r){"use strict";r.d(t,{E7:function(){return u},G5:function(){return c},V1:function(){return l.V1},lx:function(){return m}});var n=r(738),o=r(3301),l=r(3491),a=r(257);let s={apiKey:a.env.NEXT_PUBLIC_FIREBASE_API_KEY,authDomain:a.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,projectId:a.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,storageBucket:a.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,messagingSenderId:a.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,appId:a.env.NEXT_PUBLIC_FIREBASE_APP_ID},i=null,d=null;function c(){if(!s.apiKey||!s.projectId)return null;if(!i){let e=(0,n.C6)();i=e.length>0?e[0]:(0,n.ZF)(s)}return i}function u(){let e=c();return e?(d||(d=(0,o.getAuth)(e)),d):null}function m(e){let t=c();return t?(0,l.$C)(t,null!=e?e:"asia-northeast1"):null}},5480:function(e,t,r){"use strict";r.d(t,{l:function(){return l},o:function(){return o}});var n=r(7293);let o=[{id:"natural",name:"ナチュラル",description:"落ち着いた自然な配色",theme:{buttonColor:"#4a7c59",headerColor:"#3d6b4d",backgroundColor:"#faf8f5",textColor:"#1f2937",fontFamily:"sans-serif",primaryColor:"#4a7c59"}},{id:"marine",name:"マリン",description:"海をイメージした青系",theme:{buttonColor:"#2563eb",headerColor:"#1d4ed8",backgroundColor:"#f0f9ff",textColor:"#1e3a5f",fontFamily:"sans-serif",primaryColor:"#2563eb"}},{id:"warm",name:"ウォーム",description:"温かみのあるオレンジ・ベージュ",theme:{buttonColor:"#c2410c",headerColor:"#9a3412",backgroundColor:"#fff7ed",textColor:"#431407",fontFamily:"sans-serif",primaryColor:"#c2410c"}},{id:"minimal",name:"ミニマル",description:"シンプル・白基調",theme:{buttonColor:"#171717",headerColor:"#262626",backgroundColor:"#ffffff",textColor:"#171717",fontFamily:"sans-serif",primaryColor:"#171717"}},{id:"craft",name:"クラフト",description:"ハンドメイド向けナチュラル",theme:{buttonColor:"#6b4423",headerColor:"#5c3d1f",backgroundColor:"#fef3c7",textColor:"#292524",fontFamily:"serif",primaryColor:"#6b4423"}}];async function l(e){if(!(0,n.G5)())return o;try{var t;let r=(0,n.lx)("asia-northeast1");if(!r)return o;let l=(0,n.V1)(r,"generateDesignPresets"),a=await l({onboarding:e});return null!==(t=a.data.presets)&&void 0!==t?t:o}catch(e){return o}}}},function(e){e.O(0,[990,322,448,971,117,744],function(){return e(e.s=2662)}),_N_E=e.O()}]);