(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[671],{915:function(e,t,a){Promise.resolve().then(a.bind(a,9161))},9161:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var r=a(7437),l=a(2265),s=a(7648),n=a(9376),i=a(5978),o=a(3168),c=a(2268),u=a(31),d=a(3465),m=a(6942),h=a(6679),x=a(7293),b=a(316),f=a(2489),g=a(3581),p=a(3113),y=a(875);let v=(0,a(9205).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var w=a(9397);let j="marche-link-quick-first-after-onboarding",N="marche-link-quick-onboarding-modal-seen",k="marche-link-quick-step2-callout-seen";function C(){let e=(0,n.useSearchParams)(),t=(0,l.useRef)(null),a=(0,l.useRef)(null),C=(0,l.useRef)(null),{user:S}=(0,m.a)(),{storeIds:E,loading:R,newOrderNotificationEnabled:P}=(0,h.dD)(),[Z,L]=(0,l.useState)(""),[z,D]=(0,l.useState)(!1),[F,I]=(0,l.useState)(!1),T=(0,l.useRef)(null),[U,M]=(0,l.useState)(null),[A,O]=(0,l.useState)(null),[W,q]=(0,l.useState)(!1),[H,X]=(0,l.useState)(null),[_,B]=(0,l.useState)(""),[J,K]=(0,l.useState)(!1),[Q,$]=(0,l.useState)(""),[V,G]=(0,l.useState)(""),[Y,ee]=(0,l.useState)(o.HR),[et,ea]=(0,l.useState)(o.X0),[er,el]=(0,l.useState)(o.ST),[es,en]=(0,l.useState)(o.X0[0]),[ei,eo]=(0,l.useState)(o.ST[0]),[ec,eu]=(0,l.useState)(null),[ed,em]=(0,l.useState)(null),[eh,ex]=(0,l.useState)(!1),[eb,ef]=(0,l.useState)(null),[eg,ep]=(0,l.useState)(!1),[ey,ev]=(0,l.useState)(!1),[ew,ej]=(0,l.useState)(""),[eN,ek]=(0,l.useState)(""),[eC,eS]=(0,l.useState)(!1),[eE,eR]=(0,l.useState)(!1),eP=(0,l.useRef)(null),eZ=(0,l.useRef)(null),[eL,ez]=(0,l.useState)(""),[eD,eF]=(0,l.useState)(!1);(0,l.useEffect)(()=>{E.length>=1&&!R?L(e=>e&&E.includes(e)?e:E[0]):0!==E.length||R||L("")},[E,R]),(0,l.useEffect)(()=>{(null!=e.get("created")||"1"===sessionStorage.getItem(j))&&"1"!==sessionStorage.getItem(N)?D(!0):"1"===sessionStorage.getItem(N)&&"1"!==sessionStorage.getItem(k)&&I(!0)},[e]),(0,l.useEffect)(()=>{if(!(null==S?void 0:S.uid))return;let e=!1;return(0,c.b)(S.uid).then(t=>{if(e)return;let a=t.productNames.length>0?t.productNames:o.HR,r=t.units.length>0?t.units:o.X0,l=t.categories.length>0?t.categories:o.ST;ee(a),ea(r),el(l),en(e=>r.includes(e)?e:r[0]),eo(e=>l.includes(e)?e:l[0])}),()=>{e=!0}},[null==S?void 0:S.uid]),(0,l.useEffect)(()=>{let e=e=>{eP.current&&!eP.current.contains(e.target)&&(ep(!1),eS(!1),ej("")),eZ.current&&!eZ.current.contains(e.target)&&(ev(!1),eR(!1),ek(""))};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}},[]);let eI=(0,l.useCallback)(async()=>{let e=ew.trim();if(!e||!(null==S?void 0:S.uid))return;if(et.includes(e)){en(e),eS(!1),ej(""),ep(!1);return}let t=[e,...et];ea(t),en(e),eS(!1),ej(""),ep(!1),await (0,c.x)(S.uid,{productNames:Y,units:t,categories:er})},[ew,null==S?void 0:S.uid,et,Y,er]),eT=(0,l.useCallback)(async()=>{let e=eN.trim();if(!e||!(null==S?void 0:S.uid))return;if(er.includes(e)){eo(e),eR(!1),ek(""),ev(!1);return}let t=[e,...er];el(t),eo(e),eR(!1),ek(""),ev(!1),await (0,c.x)(S.uid,{productNames:Y,units:et,categories:t})},[eN,null==S?void 0:S.uid,er,Y,et]),eU=(0,l.useCallback)(()=>{var e;null===(e=C.current)||void 0===e||e.getTracks().forEach(e=>e.stop()),C.current=null,q(!1),X(null)},[]),eM=(0,l.useCallback)(async()=>{X(null);try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:1280}},audio:!1});C.current=e,q(!0)}catch(e){X(e instanceof Error?e.message:"カメラを起動できませんでした"),q(!1)}},[]);(0,l.useEffect)(()=>{if(!W||!C.current)return;let e=a.current;if(e)return e.srcObject=C.current,e.play().catch(()=>{}),()=>{e.srcObject=null}},[W]);let eA=(0,l.useCallback)(()=>{let e=a.current;e&&C.current&&!(e.readyState<2)&&new Promise((t,a)=>{let r=Math.min(e.videoWidth,e.videoHeight),l=(e.videoWidth-r)/2,s=(e.videoHeight-r)/2,n=document.createElement("canvas");n.width=r,n.height=r;let i=n.getContext("2d");if(!i){a(Error("Canvas not available"));return}i.drawImage(e,l,s,r,r,0,0,r,r),n.toBlob(e=>{if(!e){a(Error("Failed to create blob"));return}t({blob:e,dataUrl:n.toDataURL("image/jpeg",.9)})},"image/jpeg",.9)}).then(e=>{let{blob:t,dataUrl:a}=e,r=new File([t],"capture.jpg",{type:"image/jpeg"});eU(),O(r),M(a),eu(null),em(null)},()=>X("撮影に失敗しました"))},[eU]);(0,l.useEffect)(()=>()=>{var e;null===(e=C.current)||void 0===e||e.getTracks().forEach(e=>e.stop()),C.current=null},[]);let eO=()=>{eU(),M(null),O(null),eu(null),em(null)},eW=async e=>{if(em(null),A&&Z.trim()){ex(!0);try{var t,a,r;let l=(null==U?void 0:U.startsWith("data:"))?U:A,s=await (0,d.R)(l),n=new FormData;n.append("image",s,"product.jpg"),n.append("subdomain",Z.trim().toLowerCase());let c=await fetch("/upload-product-image.php",{method:"POST",body:n}),u=await c.json().catch(()=>({}));if(!c.ok)throw Error(u.message||"アップロード失敗 (".concat(c.status,")"));let m=null!==(t=u.url)&&void 0!==t?t:null;eu(m);let h=(0,x.T)();if(h&&m){let t={title:_.trim()||"（無題）",imageUrl:m,category:ei,price:parseInt(Q,10)||0,stockQuantity:""===V.trim()?0:Math.max(0,parseInt(V,10)||0),unit:es||"",published:!!e,createdAt:(0,i.Bt)()};eL.trim()&&(t.description=eL.trim()),await (0,i.ET)((0,i.hJ)(h,"stores",Z.trim().toLowerCase(),"products"),t)}ef({message:e?"".concat(_||"（無題）"," / \xa5").concat(Q||"0"," / ").concat(es," / ").concat(ei):"".concat(_||"（無題）"," / \xa5").concat(Q||"0"," / ").concat(es," / ").concat(ei,"\n商品一覧で確認できます。"),published:!!e}),P&&(0,b.i)(Z.trim()||null),eO(),B(""),ez(""),eF(!1),$(""),G(""),en(null!==(a=et[0])&&void 0!==a?a:o.X0[0]),eo(null!==(r=er[0])&&void 0!==r?r:o.ST[0])}catch(t){let e=t instanceof Error?t.message:"アップロードに失敗しました";em(e),alert("保存に失敗しました: ".concat(e))}finally{ex(!1)}}else alert(A&&!Z.trim()?"写真を保存するには、ログインしてショップを登録してください。":"出品: ".concat(_||"（未入力）"," / \xa5").concat(Q||"0"," / ").concat(es," / ").concat(ei))},eq=(0,l.useCallback)(()=>{if(D(!1),sessionStorage.setItem(N,"1"),sessionStorage.removeItem(j),"1"!==sessionStorage.getItem(k)&&I(!0),null!=e.get("created")){let e=new URL(window.location.href);e.searchParams.delete("created"),window.history.replaceState({},"",e.pathname+e.search)}},[e]),eH=(0,l.useCallback)(()=>{I(!1),sessionStorage.setItem(k,"1")},[]);return(0,r.jsxs)("div",{className:"flex flex-col pb-24",children:[z&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"onboarding-quick-title",children:(0,r.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-5 shadow-lg",children:[(0,r.jsx)("h2",{id:"onboarding-quick-title",className:"text-center text-sm font-medium text-gray-800",children:"お店、もうできてます！ まずは1点出品して、お店の様子を確認してみよう。"}),(0,r.jsx)("button",{type:"button",onClick:eq,className:"mt-4 w-full min-h-touch rounded-xl bg-[var(--admin-accent)] py-3 text-sm font-medium text-white active:opacity-90",children:"はじめる"})]})}),(0,r.jsxs)("section",{className:"w-full shrink-0",children:[(0,r.jsxs)("div",{className:"relative w-full aspect-square max-w-md mx-auto rounded-lg border-2 border-dashed border-gray-200 bg-gray-50 overflow-hidden",children:[(0,r.jsx)("input",{ref:t,type:"file",accept:"image/*",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;O(a),eu(null),em(null);let r=new FileReader;r.onload=()=>{M(r.result)},r.readAsDataURL(a),e.target.value=""},className:"hidden","aria-hidden":!0}),U?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{src:U,alt:"商品プレビュー",className:"absolute inset-0 z-0 h-full w-full object-cover object-center pointer-events-none",style:{objectPosition:"center center"}}),(0,r.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),eO()},className:"absolute top-2 right-2 z-20 flex min-h-touch min-w-touch items-center justify-center rounded-full bg-black/50 text-white shadow-md hover:bg-black/70 active:bg-black/70","aria-label":"写真を削除",children:(0,r.jsx)(f.Z,{className:"h-6 w-6",strokeWidth:2.5})})]}):W?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("video",{ref:a,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute inset-0 z-0 h-full w-full object-cover object-center",style:{objectPosition:"center center"}}),(0,r.jsx)("div",{className:"absolute inset-x-0 bottom-0 z-20 flex justify-center pb-4",children:(0,r.jsx)("button",{type:"button",onClick:eA,className:"flex min-h-[56px] min-w-[56px] items-center justify-center rounded-full border-4 border-white bg-white/90 shadow-lg active:scale-95","aria-label":"撮影",children:(0,r.jsx)("span",{className:"h-10 w-10 rounded-full bg-gray-800"})})}),(0,r.jsx)("button",{type:"button",onClick:eU,className:"absolute top-2 right-2 z-20 flex min-h-touch min-w-touch items-center justify-center rounded-full bg-black/50 text-white","aria-label":"キャンセル",children:(0,r.jsx)(f.Z,{className:"h-6 w-6",strokeWidth:2.5})})]}):(0,r.jsxs)("div",{className:"absolute inset-0 z-0 flex items-center justify-center p-4",children:[(0,r.jsx)("button",{type:"button",onClick:eM,className:"flex min-h-touch flex-col items-center justify-center rounded-2xl border-2 border-gray-300 bg-white px-10 py-8 shadow-md active:scale-[0.98] active:bg-gray-50","aria-label":"カメラを起動",children:(0,r.jsx)(g.Z,{className:"h-16 w-16 text-gray-600","aria-hidden":!0})}),(0,r.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=t.current)||void 0===e?void 0:e.click()},className:"absolute bottom-3 right-3 flex h-12 w-12 items-center justify-center rounded-xl border border-gray-200 bg-white/90 shadow active:bg-gray-100","aria-label":"アルバムから選択",children:(0,r.jsx)(p.Z,{className:"h-6 w-6 text-gray-500","aria-hidden":!0})})]})]}),H&&(0,r.jsx)("p",{className:"mt-1 text-sm text-amber-700",role:"alert",children:H}),ed&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",role:"alert",children:ed})]}),!R&&!S&&(0,r.jsx)("p",{className:"mt-4 text-base text-gray-600",children:"ログインすると紐づいているショップに保存できます。"}),!R&&S&&0===E.length&&(0,r.jsxs)("p",{className:"mt-4 text-base text-gray-600",children:["ショップがありません。",(0,r.jsx)(s.default,{href:"/admin/register",className:"text-[var(--admin-accent)] underline ml-1",children:"新規ショップ登録"}),"を完了すると保存できます。"]}),(0,r.jsxs)("section",{className:"mt-6",ref:T,children:[(0,r.jsx)("label",{htmlFor:"product-name",className:"mb-2 block text-base font-medium text-gray-800",children:"商品名"}),(0,r.jsxs)("div",{className:"relative",children:[F&&(0,r.jsxs)("div",{className:"absolute z-20 left-0 right-0 bottom-full mb-2",role:"dialog","aria-live":"polite","aria-label":"案内",children:[(0,r.jsxs)("div",{className:"rounded-xl border border-gray-200 bg-white px-4 py-3 shadow-lg",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-800",children:"ここに商品名を入れて、1点出品してみよう。"}),(0,r.jsx)("div",{className:"mt-3 flex justify-end",children:(0,r.jsx)("button",{type:"button",onClick:eH,className:"min-h-touch rounded-full bg-[var(--admin-accent)] px-4 py-2 text-sm font-medium text-white shadow-sm active:opacity-90","aria-label":"閉じる",children:"OK"})})]}),(0,r.jsx)("div",{className:"absolute left-6 top-full w-0 h-0 border-l-[8px] border-l-transparent border-r-[8px] border-r-transparent border-t-[8px] border-t-white","aria-hidden":!0})]}),J&&(0,r.jsx)("ul",{className:"absolute z-10 bottom-full left-0 right-0 mb-1 max-h-48 w-full overflow-auto rounded-lg border border-gray-200 bg-white py-1 shadow-lg",role:"listbox",children:Y.filter(e=>e.toLowerCase().includes(_.toLowerCase())).map(e=>(0,r.jsx)("li",{children:(0,r.jsx)("button",{type:"button",className:"w-full px-3 py-2 text-left text-base hover:bg-gray-100",onMouseDown:t=>{t.preventDefault(),B(e),K(!1)},role:"option",children:e})},e))}),(0,r.jsx)("input",{id:"product-name",type:"text",inputMode:"text",lang:"ja",value:_,onChange:e=>B(e.target.value),onFocus:()=>K(!0),onBlur:()=>setTimeout(()=>K(!1),150),placeholder:Y[0]?"例: ".concat(Y[0]):"例: 商品名",className:"w-full rounded-xl border border-gray-300 px-4 py-4 text-lg",autoComplete:"off"})]})]}),(0,r.jsxs)("section",{className:"mt-4",children:[(0,r.jsxs)("button",{type:"button",onClick:()=>eF(!eD),className:"flex w-full items-center gap-2 rounded-xl border border-gray-200 bg-gray-50 px-4 py-3 text-left text-sm text-gray-600 hover:bg-gray-100",children:[(0,r.jsx)(y.Z,{className:"h-4 w-4 transition-transform ".concat(eD?"rotate-180":"")}),(0,r.jsxs)("span",{children:["商品説明を追加",eL.trim()?"（入力済み）":"（任意）"]})]}),eD&&(0,r.jsx)("div",{className:"mt-2",children:(0,r.jsx)("textarea",{id:"description",value:eL,onChange:e=>ez(e.target.value),placeholder:"こだわりや魅力をお客様に伝えましょう（任意）",rows:3,className:"w-full rounded-xl border border-gray-300 px-4 py-3 text-base resize-none"})})]}),(0,r.jsxs)("section",{className:"mt-6 grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"price",className:"mb-2 block text-base font-medium text-gray-800",children:"価格（円）"}),(0,r.jsx)("input",{id:"price",type:"text",inputMode:"numeric",pattern:"[0-9]*",autoComplete:"off",value:Q,onChange:e=>$(e.target.value.replace(/\D/g,"")),placeholder:"0",className:"w-full rounded-xl border border-gray-300 px-4 py-4 text-xl"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"stockQuantity",className:"mb-2 block text-base font-medium text-gray-800",children:"在庫数量"}),(0,r.jsx)("input",{id:"stockQuantity",type:"text",inputMode:"numeric",pattern:"[0-9]*",autoComplete:"off",value:V,onChange:e=>G(e.target.value.replace(/\D/g,"")),placeholder:"0",className:"w-full rounded-xl border border-gray-300 px-4 py-4 text-xl"})]})]}),(0,r.jsxs)("section",{className:"mt-6 grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{ref:eP,className:"relative",children:[(0,r.jsx)("label",{className:"mb-2 block text-base font-medium text-gray-800",children:"単位"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{ep(!eg),ev(!1)},className:"flex w-full items-center justify-between rounded-xl border border-gray-300 bg-white px-4 py-4 text-lg text-left",children:[(0,r.jsx)("span",{children:es}),(0,r.jsx)(y.Z,{className:"h-5 w-5 text-gray-400 transition-transform ".concat(eg?"rotate-180":"")})]}),eg&&(0,r.jsxs)("div",{className:"absolute z-30 left-0 right-0 top-full mt-1 max-h-64 overflow-auto rounded-xl border border-gray-200 bg-white shadow-lg",children:[(0,r.jsx)("ul",{className:"py-1",role:"listbox",children:et.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{type:"button",onClick:()=>{en(e),ep(!1)},className:"flex w-full items-center gap-2 px-4 py-3 text-left text-base ".concat(e===es?"bg-gray-100 font-medium":"hover:bg-gray-50"),role:"option","aria-selected":e===es,children:[e===es&&(0,r.jsx)(v,{className:"h-4 w-4 text-[var(--admin-accent)]"}),(0,r.jsx)("span",{className:e===es?"":"ml-6",children:e})]})},e))}),(0,r.jsx)("div",{className:"border-t border-gray-100",children:eC?(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2",children:[(0,r.jsx)("input",{type:"text",value:ew,onChange:e=>ej(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),eI())},placeholder:"新しい単位",className:"flex-1 rounded-lg border border-gray-300 px-3 py-2 text-base",autoFocus:!0}),(0,r.jsx)("button",{type:"button",onClick:eI,disabled:!ew.trim(),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[var(--admin-accent)] text-white disabled:opacity-50",children:(0,r.jsx)(v,{className:"h-5 w-5"})})]}):(0,r.jsxs)("button",{type:"button",onClick:()=>eS(!0),className:"flex w-full items-center gap-2 px-4 py-3 text-left text-base text-[var(--admin-accent)] hover:bg-gray-50",children:[(0,r.jsx)(w.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"追加する"})]})})]})]}),(0,r.jsxs)("div",{ref:eZ,className:"relative",children:[(0,r.jsx)("label",{className:"mb-2 block text-base font-medium text-gray-800",children:"カテゴリ"}),(0,r.jsxs)("button",{type:"button",onClick:()=>{ev(!ey),ep(!1)},className:"flex w-full items-center justify-between rounded-xl border border-gray-300 bg-white px-4 py-4 text-lg text-left",children:[(0,r.jsx)("span",{children:ei}),(0,r.jsx)(y.Z,{className:"h-5 w-5 text-gray-400 transition-transform ".concat(ey?"rotate-180":"")})]}),ey&&(0,r.jsxs)("div",{className:"absolute z-30 left-0 right-0 top-full mt-1 max-h-64 overflow-auto rounded-xl border border-gray-200 bg-white shadow-lg",children:[(0,r.jsx)("ul",{className:"py-1",role:"listbox",children:er.map(e=>(0,r.jsx)("li",{children:(0,r.jsxs)("button",{type:"button",onClick:()=>{eo(e),ev(!1)},className:"flex w-full items-center gap-2 px-4 py-3 text-left text-base ".concat(e===ei?"bg-gray-100 font-medium":"hover:bg-gray-50"),role:"option","aria-selected":e===ei,children:[e===ei&&(0,r.jsx)(v,{className:"h-4 w-4 text-[var(--admin-accent)]"}),(0,r.jsx)("span",{className:e===ei?"":"ml-6",children:e})]})},e))}),(0,r.jsx)("div",{className:"border-t border-gray-100",children:eE?(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2",children:[(0,r.jsx)("input",{type:"text",value:eN,onChange:e=>ek(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),eT())},placeholder:"新しいカテゴリ",className:"flex-1 rounded-lg border border-gray-300 px-3 py-2 text-base",autoFocus:!0}),(0,r.jsx)("button",{type:"button",onClick:eT,disabled:!eN.trim(),className:"flex h-10 w-10 items-center justify-center rounded-lg bg-[var(--admin-accent)] text-white disabled:opacity-50",children:(0,r.jsx)(v,{className:"h-5 w-5"})})]}):(0,r.jsxs)("button",{type:"button",onClick:()=>eR(!0),className:"flex w-full items-center gap-2 px-4 py-3 text-left text-base text-[var(--admin-accent)] hover:bg-gray-50",children:[(0,r.jsx)(w.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"追加する"})]})})]})]})]}),(0,r.jsxs)("section",{className:"mt-6 space-y-2",children:[(0,r.jsx)("button",{type:"button",disabled:eh,className:"flex min-h-touch w-full items-center justify-center rounded-xl bg-[var(--admin-accent)] py-4 text-lg font-semibold text-white active:opacity-90 disabled:opacity-50",onClick:()=>eW(!0),children:eh?"保存中…":"出品する"}),(0,r.jsx)("button",{type:"button",disabled:eh,className:"flex min-h-touch w-full items-center justify-center rounded-xl border-2 border-[var(--admin-accent)] bg-white py-3 text-base font-medium text-[var(--admin-accent)] active:bg-gray-50 disabled:opacity-50",onClick:()=>eW(!1),children:"下書きに保存"})]}),eb&&(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"success-modal-title",children:(0,r.jsxs)("div",{className:"w-full max-w-sm rounded-2xl bg-white p-6 shadow-lg relative z-10",children:[(0,r.jsx)("h2",{id:"success-modal-title",className:"text-center text-xl font-semibold text-gray-900",children:eb.published?"出品しました":"下書きに保存しました"}),(0,r.jsx)("p",{className:"mt-4 whitespace-pre-line text-2xl font-semibold text-gray-800",children:eb.message}),eb.published&&Z&&(0,r.jsx)("a",{href:"".concat(u.Dj,"?shop=").concat(encodeURIComponent(Z.trim().toLowerCase())),target:"_blank",rel:"noopener noreferrer",className:"mt-4 flex min-h-touch w-full items-center justify-center rounded-xl bg-[var(--admin-accent)] py-4 text-lg font-medium text-white active:opacity-90",children:"商品を自分のストアで見る"}),(0,r.jsx)("button",{type:"button",onClick:()=>ef(null),className:"mt-3 flex min-h-touch w-full items-center justify-center rounded-xl border-2 border-[var(--admin-accent)] bg-white py-4 text-lg font-medium text-[var(--admin-accent)] active:bg-gray-50 ".concat(eb.published&&Z?"":"mt-6"),children:"OK"})]})})]})}},3168:function(e,t,a){"use strict";a.d(t,{HR:function(){return r},ST:function(){return s},X0:function(){return l}});let r=["クロワッサン","メロンパン","アップルパイ","食パン","カレーパン","惣菜パン","飲み物"],l=["個","本","束","ケース","箱","袋","パック"],s=["パン","飲み物","惣菜","その他"]},2268:function(e,t,a){"use strict";a.d(t,{b:function(){return o},x:function(){return c}});var r=a(5978),l=a(7293),s=a(3168);let n={productNames:[...s.HR],units:[...s.X0],categories:[...s.ST]};function i(e){return Array.isArray(e)&&e.every(e=>"string"==typeof e)}async function o(e){let t=(0,l.T)();if(!t)return n;let a=await (0,r.QT)((0,r.JU)(t,"adminUsers",e));if(!a.exists())return n;let s=a.data();return{productNames:i(null==s?void 0:s.presetProductNames)?s.presetProductNames:n.productNames,units:i(null==s?void 0:s.presetUnits)?s.presetUnits:n.units,categories:i(null==s?void 0:s.presetCategories)?s.presetCategories:n.categories}}async function c(e,t){let a=(0,l.T)();a&&await (0,r.pl)((0,r.JU)(a,"adminUsers",e),{presetProductNames:t.productNames,presetUnits:t.units,presetCategories:t.categories},{merge:!0})}},316:function(e,t,a){"use strict";a.d(t,{S:function(){return s},i:function(){return n}});var r=a(5978),l=a(7293);let s="marche-link:new-orders";async function n(e){let t=(0,l.T)(),a=null==e?void 0:e.trim().toLowerCase();if(t&&a)try{let e=(0,r.IO)((0,r.hJ)(t,"stores",a,"orders"),(0,r.ar)("status","==","unpaid"),(0,r.b9)(100)),l=(await (0,r.PL)(e)).size;l>0&&window.dispatchEvent(new CustomEvent(s,{detail:{count:l}}))}catch(e){}}},3465:function(e,t,a){"use strict";function r(e){return new Promise((t,a)=>{let r="string"==typeof e&&e.startsWith("data:"),l=e=>{let r=new Image;r.onload=()=>{let e=document.createElement("canvas");e.width=1e3,e.height=1e3;let l=e.getContext("2d");if(!l){a(Error("Canvas context not available"));return}let s=Math.max(1e3/r.width,1e3/r.height),n=r.width,i=r.height;l.drawImage(r,(n-1e3/s)/2,(i-1e3/s)/2,1e3/s,1e3/s,0,0,1e3,1e3),e.toBlob(e=>{e?t(e):a(Error("Failed to create blob"))},"image/jpeg",.9)},r.onerror=()=>a(Error("Failed to load image")),r.src=e};r?l(e):new Promise((t,a)=>{let r=new FileReader;r.onload=()=>{let e=r.result;"string"==typeof e&&e.startsWith("data:")?t(e):a(Error("Failed to read file as data URL"))},r.onerror=()=>a(Error("Failed to load image")),r.readAsDataURL(e)}).then(l).catch(a)})}a.d(t,{R:function(){return r}})},9205:function(e,t,a){"use strict";a.d(t,{Z:function(){return o}});var r=a(2265);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,iconNode:d,...m}=e;return(0,r.createElement)("svg",{ref:t,...n,width:l,height:l,stroke:a,strokeWidth:o?24*Number(i)/Number(l):i,className:s("lucide",c),...m},[...d.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(u)?u:[u]])}),o=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:o,...c}=a;return(0,r.createElement)(i,{ref:n,iconNode:t,className:s("lucide-".concat(l(e)),o),...c})});return a.displayName="".concat(e),a}},3581:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},875:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3113:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},9397:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[358,990,249,648,679,971,117,744],function(){return e(e.s=915)}),_N_E=e.O()}]);